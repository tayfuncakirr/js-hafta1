<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>

       
/*------------------------------------------FETCH ILE VERI CEKME---------------------------------------------

// fetch() js'in sunduğu bir fonksiyondur.Web'den veri almak için kullanılır.Bu veriler genellikle API olur.
// fetch ("url") <= burada API den veri isteği atar.
// reponse.json() <=gelen yanıtı json formatına çevirir(parse).
// console.log(data) <= veriyi kullanır. örnekte console ekranına basar.

        fetch ("https://jsonplaceholder.typicode.com/users") //fetch ile url veriye ulaşıyoruz.
        .then(response => response.json())                   //gelen veriyi json a dönüştürüyoruz.
        .then(data => {                                      
            console.log(data);                               //artık gelen verileri burada kullanıyoruz.
        })

//---------------------------------------------------------------------------------------------------

API ler genelde json formatında veri döner. 

{"isim": "tayfun",
 "yas":25
}
 response.json bu metni js objesine ceviriyor.

  fetch ("...")
        .then(response => response.json())
        .then(data => {
            console.log(data.isim); // tayfun // artık burada veriye ulaşıyoruz.
        })
 */


        //  ---------------------------- ASYNC ve AWAIT ----------------------------------
    
    // senkron yapıları asenkron, sıralı halde kullanmamızı sağlayan yapıdır.
    // .then() zincirlemesi yerine, kodu daha okunabilir hale getirmek için async/await kullanabiliriz.
    // fonksiyonun başına async yazmadan await kullanılamaz (async) zorunludur.

        async function dataFetch(){   
            const response = await fetch ("https://jsonplaceholder.typicode.com/users"); // fetch tamamlanana kadar bekler.
            const data = await response.json();

        data.forEach((user) =>{
            console.log(user.name);
        });
        }
           dataFetch();

        /*
        -------------------------------------------------
        async function wait(){
            console.log("başladı...")
            await setTimeout(()=>{
              console.log("3 saniye sonra çalıştım")
            },3000)
            
        }
        wait()

        --------------------------------------------------


        */

    /*------------------------------TRY/CATCH HATA KONTROLU-----------------------------------*/

    // try = hatanın oluşma ihtimali olan kod bloklarını try bloğu içine yazıyoruz.
    // catch = hata nın sonucunda dönen senaryo, uyarı yı burada belirtip yakalıyoruz.
    // throw = manuel hata oluşturur, test amaçlı kullanılır.

    async function dataGet(){
        try{
        const res = await fetch ("https://kafanagore.api/data")
        const data = await res.json();
        console.log("veri: ", data)
        }
        catch(err){
            console.log("hata oluştu", err)
       }
        
        }
        dataGet();

        

        

    // ----------------------------------PROMISE------------------------------------------//
/*

        JS,de promise'lar asenkron işlemleri yönetmek ve sonuçlarını elde etmek için kullanılan yapılardır.
    Bir promise nesnesi, gelecekte tamamlanacak bir işlemi temsil eder ve bu işlemin sonucunu elde etmek için bir dizi 
    işlem yapılmasını sağlar.

    Promiseler nasıl çalışır?
    JS, asenkron işlemlerle çalışır.Bu işlemler, uzun süren işlemler,ağ istekleri vb olabilir.Asenkron işlemler,
    işlem tamamlanmadan diğer işlemlerin tamamlanmasına izin verir, böylece arayüz kullanıcı ya tepki verir ve kilitlenmez.

    Promiselerin oluşturulması:

    Promiseler, new Promise() yapısıyla oluşturulur ve işlem tamamlandığında resolve reject çağırılarak sonuç döndürür
    yani iki sonuç durumu vardır, başarı durumu (resolve) ile döndürülürken hata durumu ise (reject) ile belirlenir.


    .then() ve .catch() zinciri:

    then ve catch kullanarak promiselerin sonucunu işleyebiliriz.
    .then() yönetimi, promiselerin başarı durumunda çalışacağı işlevi tanımlar.
    .catch yönetimi ise bir promise nin hata durumunda çalışacağı işlevi tanımlar.

------------------------- NORMAL ASENKRON OLUŞTURMA

console.log(" ilk işlem basladı");
setTimeout(()=>{
    console.log("asenkron işlem tamamlandı.")  --asenkron çalışacak işlem
},3000);

console.log("2. işlem devam ediyor")

cıktı:
// ilk işlem başladı 
// 2.işlem devam ediyor
// asenkron işlem tamamlandı.(3 saniye sonra) 

yukarıdaki örnekte, settimeout fonksiyonu asenkron olarak çalışıyor. 
---------------

console.log("ilk işlem başladı.");
  function wait(){
    return new Promise((resolve) => {
        setTimeout(()=>{
            resolve("asenkron işlem tamamlandı.");
            
        },3000);
    })
  }
  //yapıyı burada çağırıyoruz, bu şekilde istedğimiz zaman başlatabiliriz veya hata kontrolü yapabiliriz.
wait().then((messages) =>{
    console.log(messages);
});

console.log("2. işlem devam ediyor.")

------------------------------------------------------

const cayDemle = new Promise((resolve,reject)=>{
      let suVarMi = true 
      if(suVarMi){
        resolve("su var çay hazır")
      }
      else {
        reject("su yok çay olmuyor")
      }
    })

    cayDemle.then((mesaj)=>{
      console.log("başarılı", mesaj)
    })
    .catch((hata)=>{
      console.log("hata", hata)
    })

    NOT: then zincirini kullanmak istemiyorsanız async fonksiyon oluşturarak çağırılabilir.


*/

  
    </script>

    
</body>
</html>